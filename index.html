<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>BET300 Â· Cofre de la suerte</title>
<meta name="theme-color" content="#0b0f1e"/>
<style>
:root{
  --bg:#0b0f1e; --panel:#121634; --panel2:#0f1330; --border:#1e2150;
  --text:#e8ebff; --muted:#b7b9d6; --ok:#25D366; --accent:#ffd166; --accent2:#ff8f66;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;color:var(--text);background:var(--bg);font:16px/1.35 system-ui,-apple-system,Segoe UI,Roboto}
body::before{
  content:""; position:fixed; inset:0; z-index:-2;
  background:
   radial-gradient(900px 500px at 50% -10%, rgba(101,74,255,.22), transparent),
   radial-gradient(700px 350px at 100% 0%, rgba(0,209,255,.16), transparent),
   linear-gradient(180deg,#0b0f1e 0%,#0b0f1e 60%,#0a0d20 100%);
}

/* layout */
.container{max-width:1100px;margin:16px auto;padding:0 16px 96px}
.card{background: radial-gradient(120% 100% at 50% 0%, rgba(124,77,255,.08), transparent), var(--panel2);
  border:1px solid var(--border); border-radius:18px; padding:18px; box-shadow:0 15px 40px rgba(0,0,0,.35)}
@media (max-width:520px){.container{padding:0 0 108px}.card{border-radius:0;border-left:0;border-right:0;padding:14px}}

.head{display:flex;align-items:center;gap:12px;flex-wrap:wrap;margin-bottom:14px}
.brand{display:inline-flex;align-items:center;gap:10px;background:linear-gradient(90deg,#ffb366,#ff7a3d);
  color:#121212;border-radius:14px;padding:10px 14px;font-weight:900;letter-spacing:.5px;box-shadow:0 6px 20px rgba(0,0,0,.35)}
.brand .dot{width:10px;height:10px;border-radius:999px;background:#fff4;box-shadow:0 0 0 2px #0003 inset}
.pill{background:linear-gradient(90deg,rgba(124,77,255,.15),rgba(0,209,255,.15));border:1px solid var(--border);
  border-radius:999px;padding:6px 10px;font-size:12px;color:var(--muted)}
.grid{display:grid;gap:16px;grid-template-columns:1fr 360px}
@media (max-width:980px){.grid{grid-template-columns:1fr}}
.panel{background:var(--panel);border:1px solid var(--border);border-radius:16px;padding:16px}

/* tÃ­tulos */
h1,h2,h3,p{margin:0 0 8px}
h1{font-size:26px}
.muted{color:var(--muted)}

/* tablero de cofres */
.board{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:16px;margin-top:10px}
@media (max-width:520px){.board{gap:12px}}
.chest{
  position:relative; border-radius:18px; padding:16px; height:150px;
  background:
   linear-gradient(#263049,#263049) padding-box,
   radial-gradient(120% 150% at 50% -20%, #55608a, #1b2138) border-box;
  border:1px solid #3a4060; box-shadow:inset 0 20px 40px rgba(255,255,255,.04), 0 10px 25px rgba(0,0,0,.35);
  overflow:hidden; display:grid; place-items:center; cursor:pointer;
}
.chest::before, .chest::after{
  content:""; position:absolute; left:0; right:0; height:12px; background:#2b3452; opacity:.9;
  border-top:1px solid #4b5375; border-bottom:1px solid #1a1f34;
}
.chest::before{top:42px} .chest::after{bottom:36px}
.lock{
  position:absolute; width:70px; height:90px; border-radius:16px; background:linear-gradient(#c9a879,#b68c59);
  box-shadow: 0 6px 16px rgba(0,0,0,.35); display:grid; place-items:center; z-index:2;
}
.lock::after{content:""; width:28px;height:28px;border-radius:6px;background:#7a5a2e;box-shadow:inset 0 2px 0 #0004}
.lock.top{top:20px} .lock.center{top:50%; transform:translateY(-50%);} /* flex para variantes si querÃ©s */
.prize{
  position:absolute; inset:auto 12px 12px 12px; height:44px; border-radius:12px;
  display:flex; align-items:center; justify-content:center; font-weight:900;
  color:#13172b; background:linear-gradient(90deg,#ffd6a2,#ff9db1);
  border:1px solid #00000022; box-shadow:0 6px 16px rgba(0,0,0,.35); z-index:3;
  opacity:0; transform:translateY(10px); pointer-events:none;
}
.chest.open .prize{opacity:1; transform:translateY(0); transition:opacity .28s ease, transform .28s ease}
.chest.open .lock{display:none}

/* panel derecho */
.side .tag{display:inline-block;padding:6px 10px;border-radius:10px;border:1px solid #3b3f66;color:#c7ccff;margin-bottom:8px;
background:linear-gradient(90deg,#404779,#2a2f59)}
.side .box{background:radial-gradient(140% 120% at 50% 0%, rgba(124,77,255,.08), transparent),var(--panel);
  border:1px solid var(--border); border-radius:16px; padding:16px; margin-top:12px}
.btn{
  appearance:none;border:none;cursor:pointer;width:100%;
  padding:14px 16px;border-radius:14px;font-weight:900;letter-spacing:.2px;
  background:linear-gradient(90deg,#6c59ff,#00d1ff); color:#0a1020;
  box-shadow:0 10px 20px rgba(0,0,0,.35);
}
.btn.ok{background:#25D366;color:#0b0f1e}
.btn.orange{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#0a1020}

/* dock mÃ³vil fijo */
.dock{display:none}
@media (max-width:980px){
  .dock{position:fixed;left:0;right:0;bottom:0;z-index:40;
    background:linear-gradient(180deg,rgba(11,15,30,0) 0%,rgba(11,15,30,.85) 22%,rgba(11,15,30,.95) 100%);
    padding:10px 14px 14px; display:flex; gap:12px; align-items:center}
}

/* MODAL + backdrop */
.backdrop{
  position:fixed; inset:0; background:rgba(5,8,20,.75); backdrop-filter:blur(4px);
  display:none; align-items:center; justify-content:center; z-index:60;
}
.backdrop.show{display:flex}

/* modal (sin animaciÃ³n por defecto; se dispara desde JS) */
.modal{
  width:min(520px,92vw); border-radius:18px; padding:18px 18px 14px;
  background: radial-gradient(120% 100% at 50% 0%, rgba(124,77,255,.12), transparent), var(--panel2);
  border:1px solid var(--border); box-shadow:0 20px 60px rgba(0,0,0,.6);
  transform:scale(.6); opacity:0; position:relative; overflow:hidden;
}
@keyframes pop{
  0%   {transform:scale(.6);  opacity:0}
  60%  {transform:scale(1.06);opacity:1}
  100% {transform:scale(1);   opacity:1}
}
.modal h2{margin:0 0 6px;font-size:22px}
.modal .big{font-size:34px;font-weight:900;margin-bottom:8px}
.modal .row{display:flex;gap:12px;margin-top:12px}
.modal .btn{flex:1}
.xbtn{position:absolute;top:10px;right:10px;border:0;background:#ffffff14;color:#cfd3ff;padding:6px 9px;border-radius:10px;cursor:pointer}
.sparkle{
  position:absolute; width:8px;height:8px;background:radial-gradient(#fff,#ffe27a); border-radius:999px; opacity:0;
  left:50%; top:45%;
  animation: burst .9s ease forwards;
}
@keyframes burst{
  0%{opacity:0; transform:translate(0,0) scale(.6)}
  20%{opacity:1}
  100%{opacity:0; transform:translate(var(--dx),var(--dy)) scale(1.2)}
}

/* toast simple */
.toast{
  position:fixed;left:50%;bottom:90px;transform:translateX(-50%);z-index:70;
  background:#1a2144;color:#e8ebff;border:1px solid #2b3270;border-radius:12px;padding:10px 14px;
  box-shadow:0 10px 30px rgba(0,0,0,.45);opacity:0;pointer-events:none
}
.toast.show{animation:toIn .2s ease forwards, toOut .2s ease 2.2s forwards}
@keyframes toIn{to{opacity:1; transform:translateX(-50%) translateY(-6px)}}
@keyframes toOut{to{opacity:0; transform:translateX(-50%) translateY(0)}}
</style>
</head>
<body>

<div class="container">
  <div class="card">
    <div class="head">
      <div class="brand">BET300 <span class="dot"></span></div>
      <span class="pill">Promo interactiva</span>
      <span class="pill">AbrÃ­ 1 cofre por dÃ­a</span>
    </div>

    <div class="grid">
      <!-- Izquierda: tablero -->
      <div class="panel">
        <h1>ElegÃ­ tu cofre metÃ¡lico</h1>
        <p class="muted">AbrÃ­ uno para revelar tu beneficio</p>

        <div id="board" class="board"></div>
      </div>

      <!-- Derecha: premio + CTA -->
      <aside class="panel side">
        <div class="tag">ðŸŽ‰ Â¡Premio obtenido!</div>
        <div>
          <div id="prizeBig" style="font-size:40px;font-weight:900;margin-bottom:6px;">$0</div>
          <p id="prizeText" class="muted">RecibÃ­s el beneficio con tu prÃ³xima carga.</p>
        </div>

        <button id="claimBtn" class="btn ok" disabled>ðŸ“² Reclamar por WhatsApp</button>

        <div class="box">
          <h3 style="margin-bottom:6px">Acceso a la plataforma</h3>
          <p class="muted" style="margin-bottom:10px">EntrÃ¡ ahora y participÃ¡ antes de que termine.</p>
          <a id="platformBtn" class="btn orange" target="_blank" rel="noopener">ðŸŽ® Entrar a la plataforma</a>
        </div>
      </aside>
    </div>
  </div>
</div>

<!-- Dock mÃ³vil fijo -->
<div class="dock">
  <button id="mClaim" class="btn ok" disabled>ðŸ“² Reclamar</button>
  <a id="mPlatform" class="btn orange" target="_blank" rel="noopener">ðŸŽ® Plataforma</a>
</div>

<!-- Modal premio -->
<div id="backdrop" class="backdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true">
    <button id="closeModal" class="xbtn">âœ•</button>
    <h2>ðŸŽ‰ Â¡Premio obtenido!</h2>
    <div id="mAmount" class="big">$0</div>
    <p id="mText" class="muted">RecibÃ­s el beneficio con tu prÃ³xima carga.</p>
    <div class="row">
      <button id="modalClaim" class="btn ok">ðŸ“² Reclamar por WhatsApp</button>
      <button id="copyBtn" class="btn">ðŸ“‹ Copiar mensaje</button>
    </div>
  </div>
</div>

<div id="toast" class="toast">Copiado</div>

<script>
/* ===== ParÃ¡metros por PC (igual que en la ruleta) ===== */
const WP_NUMBERS = { principal:"5491157737173", pc1:"5491138601132", pc2:"5491138214312", pc3:"5491168392647" };
const PLATFORM_LINKS = { principal:"https://plataforma.example/inicio", pc1:"https://c01.bet300vip.com/", pc2:"https://c02.bet300vip.com/", pc3:"https://c03.bet300vip.com/" };

const qs = new URLSearchParams(location.search);
const pc = qs.get("pc");
let WP = WP_NUMBERS.principal;
let PLATFORM = PLATFORM_LINKS.principal;
if(pc==='1'){ WP=WP_NUMBERS.pc1; PLATFORM=PLATFORM_LINKS.pc1; }
if(pc==='2'){ WP=WP_NUMBERS.pc2; PLATFORM=PLATFORM_LINKS.pc2; }
if(pc==='3'){ WP=WP_NUMBERS.pc3; PLATFORM=PLATFORM_LINKS.pc3; }

document.getElementById('platformBtn').href = PLATFORM;
document.getElementById('mPlatform').href   = PLATFORM;

/* ===== Cofres y premios ===== */
const PRIZES = [2000, 3000, 4000, 6000, 8000, 10000]; // 6 cofres
const boardEl = document.getElementById('board');

const prizeBig = document.getElementById('prizeBig');
const prizeText= document.getElementById('prizeText');
const claimBtn = document.getElementById('claimBtn');
const mClaim   = document.getElementById('mClaim');

const backdrop = document.getElementById('backdrop');
const modalClaim = document.getElementById('modalClaim');
const mAmount = document.getElementById('mAmount');
const mText   = document.getElementById('mText');
const copyBtn = document.getElementById('copyBtn');

const toast = document.getElementById('toast');

const money = n => "$"+n.toLocaleString("es-AR");

/* ===== Estado diario ===== */
function todayKey(){ const n=new Date(); return `${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`; }
function resetIfNewDay(){
  const t=todayKey(), d=localStorage.getItem('cofre_day');
  if(!d || d!==t){ localStorage.removeItem('cofre_done'); localStorage.removeItem('cofre_prize'); localStorage.setItem('cofre_day',t); }
}
resetIfNewDay();

/* ===== UI de cofres ===== */
function chestHTML(i){
  return `
  <button class="chest" data-i="${i}" aria-label="Abrir cofre">
    <div class="lock center"></div>
    <div class="prize">$${(PRIZES[i]).toLocaleString("es-AR")}</div>
  </button>`;
}

function renderBoard(){
  boardEl.innerHTML = Array.from({length:6}, (_,i)=>chestHTML(i)).join('');
}
renderBoard();

/* ===== LÃ³gica de abrir ===== */
function winText(v){ return `RecibÃ­s <b>${money(v)} extra</b> con tu prÃ³xima carga.`; }
function waMsg(v){ return `Hola, ganÃ© ${money(v)} en el cofre y quiero reclamarlo con mi prÃ³xima carga.`; }

function showToast(msg){
  toast.textContent = msg;
  toast.classList.remove('show'); // reinicio
  void toast.offsetWidth; // reflow
  toast.classList.add('show');
}

function lockBoard(){
  boardEl.querySelectorAll('.chest').forEach(c=>c.disabled=true);
}

function openModal(amount){
  mAmount.textContent = money(amount);
  mText.innerHTML     = winText(amount);

  const msg  = waMsg(amount);
  const link = `https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;
  modalClaim.onclick = ()=>location.href=link;
  copyBtn.onclick = async ()=>{
    try{ await navigator.clipboard.writeText(msg); showToast("Mensaje copiado"); }
    catch{ showToast("CopiÃ¡ manualmente si tu navegador no lo permite"); }
  };

  const modalEl = backdrop.querySelector('.modal');

  // reinicio de animaciÃ³n para evitar parpadeos
  modalEl.style.animation = 'none';
  modalEl.style.opacity = '0';
  modalEl.style.transform = 'scale(.6)';
  // forzar reflow
  modalEl.offsetHeight;
  modalEl.style.animation = 'pop .55s cubic-bezier(.2,1,.2,1) forwards';

  // chispas decorativas
  [...modalEl.querySelectorAll('.sparkle')].forEach(n=>n.remove());
  for(let i=0;i<18;i++){
    const s=document.createElement('span');
    s.className='sparkle';
    s.style.setProperty('--dx', (Math.random()*240-120)+'px');
    s.style.setProperty('--dy', (Math.random()*120+40)+'px');
    s.style.left = (40+Math.random()*20)+'%';
    s.style.animationDelay = (Math.random()*0.6)+'s';
    modalEl.appendChild(s);
  }

  backdrop.classList.add('show');
  document.body.classList.add('modal-open');
}

function closeModal(){
  backdrop.classList.remove('show');
  document.body.classList.remove('modal-open');
}
document.getElementById('closeModal').addEventListener('click', closeModal);
// No cerramos al hacer click fuera, para que puedan leer y reclamar
backdrop.addEventListener('click', (e)=>{/* intencionalmente vacÃ­o */});
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape'){ /* bloqueado */ }});

/* abrir cofre */
boardEl.addEventListener('click', (e)=>{
  const btn = e.target.closest('.chest');
  if(!btn) return;
  if(localStorage.getItem('cofre_done')==='1'){ showToast("Ya abriste tu cofre de hoy"); return; }

  // ganador
  const prize = PRIZES[Number(btn.dataset.i)];

  // UI
  btn.classList.add('open'); // muestra la etiqueta del premio (lock desaparece)
  lockBoard();

  // panel derecho + botones
  prizeBig.textContent = money(prize);
  prizeText.innerHTML  = winText(prize);
  const msg = waMsg(prize);
  const link = `https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;
  claimBtn.disabled=false; mClaim.disabled=false;
  claimBtn.onclick = ()=>location.href=link;
  mClaim.onclick   = ()=>location.href=link;

  // persistencia diaria
  localStorage.setItem('cofre_done','1');
  localStorage.setItem('cofre_prize', String(prize));
  localStorage.setItem('cofre_day', todayKey());

  // modal premiado
  openModal(prize);
});

/* restaurar si ya ganÃ³ hoy */
(function restore(){
  const done = localStorage.getItem('cofre_done')==='1';
  const saved = Number(localStorage.getItem('cofre_prize'));
  if(done && saved){
    prizeBig.textContent = money(saved);
    prizeText.innerHTML  = winText(saved);
    claimBtn.disabled=false; mClaim.disabled=false;
    const msg = waMsg(saved);
    const link = `https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;
    claimBtn.onclick = ()=>location.href=link;
    mClaim.onclick   = ()=>location.href=link;
    lockBoard();
  }
})();
</script>
</body>
</html>
